---
title: "Alien Encounters"
subtitle: "Visualizing UFO Sightings"
author: "-- DataInk Drinkers"
title-slide-attributes:
  data-background-image: images/bg5.png
  data-background-size: "None"
  data-background-opacity: "0.7"
  data-slide-number: none
format:
  revealjs:
    theme: league
    transition: slide
    background-transition: fade
  
editor: visual
execute:
  echo: false
---

```{r}
#| label: setup
#| include: false

# Plot theme
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 11))

# set figure parameters for knitr
knitr::opts_chunk$set(
  fig.width = 7,        # 7" width
  fig.asp = 0.618,      # the golden ratio
  fig.retina = 3,       # dpi multiplier for displaying HTML output on retina
  fig.align = "center", # center align figures
  dpi = 300             # higher dpi, sharper image
)
```

# What are the number of UFO encounters globally?

## The UFO Footprints


# Question 2:

## Heading for your slide - Q2 PLot1

```{r q2-plot1}



```

## Understanding Twilight

![Types of twilight - [source: science.howstuffworks.com](https://science.howstuffworks.com/nature/climate-weather/atmospheric/twilight-dusk.htm)](images/twilight.jpg){width="6in"}

## The Confrontation

```{r, fig.width=14,fig.height=7, echo=FALSE, warning=FALSE, error=FALSE, message=FALSE}
# Libraries required
library(ggplot2)
library(hrbrthemes)
library(tidyverse)
library(ggpubr)
library(jpeg)
library(png)



# Loading data
data <- read.csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-06-20/ufo_sightings.csv")

# N=Removing NAs from the data
noNAData <- na.omit(data)

# Extracting the "day_partcolumn from the dataset"
dp <- noNAData |>
 count(day_part)

# Creating  new columns to generate a new dataframe
c1 <- dp[,1]
c2 <- dp[,2]

# Creating a new data-frame with the day-parts and the number of sightings
new <- data.frame(c1,c2) 



# Importing the background image
img <- readPNG("images/img7.png")

# Customizing y-axis ticks
 y_ticks <- c("Civil dawn", "Nautical dawn", "Astronomical dawn", "Civil dusk","Morning","Nautical dusk", "Astronomical dusk", "Afternoon", "Night")

 
# Generating the plot
ggplot(new, aes(x=c2,y = reorder(c1,c2), fill = c1)) +
  background_image(img)+
  geom_bar(stat = "identity",color="white") +
  theme_minimal()+
  scale_fill_grey() +
  scale_y_discrete(labels= y_ticks)+
  ggtitle("Sighting UFOs at distinct day-parts\n") +
  theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 20))+
  labs(x = "\nNo. of sightings",
       y = "Parts of the Day\n")+
  theme(axis.title.x = element_text(size = 14, face = "bold", hjust = 0.5),
        axis.title.y = element_text(size = 14, face = "bold", hjust = 0.5),
        axis.text.x = element_text(face="bold", size= 11),
        axis.text.y = element_text(face="bold", size= 11),
        legend.position="none",
        plot.margin = margin(t = 1,  # Top margin
                             r = 4,  # Right margin
                             b = 1,  # Bottom margin
                             l = 1,  # Left margin
                             unit = "lines"))+
  geom_text(x = 50000, # Set the position of the text to always be at '50000'
            hjust = 0,
            size = 4,
            label = c2)+
  coord_cartesian(clip = "off")
  
```

## Thank you !!

